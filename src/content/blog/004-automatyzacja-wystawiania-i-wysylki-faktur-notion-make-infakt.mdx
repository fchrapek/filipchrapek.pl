---
title: Wystawiaj i wysyÅ‚aj faktury jednym przyciskiem myszy â€” Make + Notion + Infakt API
author: Filip Chrapek
pubDatetime: 2023-09-27
postSlug: automatyzacja-fakturowania-notion-infakt-make
featured: false
ogImage: "/assets/images/auto-machine-orange.jpg"
draft: false
tags:
  - produktywnosc
  - automatyzacja
  - make
  - notion
  - infakt
  - api
description: Automatyzacja nudnych zadaÅ„ z Make! Nie traÄ‡ czasu na gÅ‚upie faktury. ZleÄ‡ to robotowi, niech siÄ™ mÄ™czy.
---

import BlogPostImage from "../../components/BlogPostImage.astro";
import Callout from "../../components/Callout.astro";

import woohooRoss from "../../assets/gifs/woohoo-ross.gif";
import makeScenario from "../../assets/images/4/make-scenario.png";
import notionTasks from "../../assets/images/4/notion-tasks-structure.png";
import makeNotionFilter from "../../assets/images/4/make-notion-filter.png";
import makeHttpCreate from "../../assets/images/4/make-http-infakt-create.png";
import makeHttpSend from "../../assets/images/4/make-http-infakt-send.png";
import makeNotionUpdateDatabase from "../../assets/images/4/make-notion-update-database-item.png";

I oto nastaÅ‚ ten czas... WÅ‚aÅ›nie dzwon wybiÅ‚ po raz trzydziesty. NieduÅ¼e stado krukÃ³w, z nieznoÅ›nym skrzekiem wzbiÅ‚o siÄ™ w powietrze, kierujÄ…c siÄ™ w stronÄ™ ledwo juÅ¼ widocznego zza horyzontu sÅ‚oÅ„ca. Okoliczni mieszkaÅ„cy pospiesznie chowajÄ… siÄ™ do swoich domostw, skrupulatnie ryglujÄ…c drzwi i okna. W powietrzu czuÄ‡ nieprzyjemny zapach potu...

StaÅ‚o siÄ™ â€“ nadszedÅ‚ koniec miesiÄ…ca.

Pora przywdziaÄ‡ ciÄ™Å¼kÄ…, antracytowÄ… togÄ™, zarzuciÄ‡ ogromny kaptur, zapaliÄ‡ dwie ceremonialne Å›wiecie i rozpoczÄ…Ä‡ przeraÅ¼ajÄ…cy rytuaÅ‚ buchalterii.

---

Ach biurokracja, ach faktury! Ulubiony temat kaÅ¼dego freelancera, od ktÃ³rego na samÄ… myÅ›l usta i rÄ™ce same skÅ‚adajÄ… siÄ™ do ekstatycznego *WOOHOO*! ğŸ‰

<BlogPostImage
  src={woohooRoss}
  alt="Ross siÄ™ cieszy, bo bÄ™dzie wystawiaÄ‡ faktury"
  figcaption="Ty, kiedy wiesz, Å¼e dzisiaj wieczorem musisz wystawiÄ‡ 17 faktur i wysÅ‚aÄ‡ je wszystkie, Å‚adnie do klientÃ³w."
/>

Tak naprawdÄ™, to nie. Koniec miesiÄ…ca ssie.

---

## Spis treÅ›ci

## Problem

ByÄ‡ moÅ¼e tak jak i ja, miesiÄ…c w miesiÄ…c wystawiasz rÄ™cznie takie same lub bardzo podobne faktury. Powiedzmy, Å¼e dla klientÃ³w, z ktÃ³rymi wiÄ…Å¼e CiÄ™ dÅ‚uÅ¼sza wspÃ³Å‚praca. I byÄ‡ moÅ¼e, podobnie jak ja, myÅ›lisz sobie _"Na bank jest jakiÅ› lepszy, sprytniejszy sposÃ³b, Å¼eby to ogarnÄ…Ä‡"_. I mimo tego, Å¼e ta myÅ›l jest caÅ‚kiem realna, to momentalnie dominowana jest przez drugÄ… myÅ›l typu: _"No dobra, przecieÅ¼ to tylko chwila, wymyÅ›lenie rozwiÄ…zania zajmie mi 5 razy tyle"_.

I tak co miesiÄ…c, w koÅ‚o Macieju.

_No more!_ Bo, caÅ‚y na biaÅ‚o (a raczej fioletowo), pojawia siÄ™ <a href="https://www.make.com/" target="_blank">Make</a>.

## RozwiÄ…zanie

Make to cudowny wynalazek. WciÄ…Å¼ odkrywam peÅ‚ne moÅ¼liwoÅ›ci tego narzÄ™dzia, natomiast juÅ¼ teraz z sukcesem wykorzystujÄ™ tÄ™ platformÄ™ do kilku regularnych czynnoÅ›ci, ktÃ³re zaliczam do kategorii _nie chcem, ale muszem_. JednÄ… z takich czynnoÅ›ci jest niewÄ…tpliwie wystawianie i wysyÅ‚anie faktur, i to wÅ‚aÅ›nie tego byka sprÃ³bujÄ™ zÅ‚apaÄ‡ za rogi.

<Callout>
  W przykÅ‚adzie korzystam z <a href="https://www.notion.so/" target="_blank">Notion</a>, jako dostawcy danych oraz z <a href="https://www.infakt.pl/polecam/fchrapek-infakt" target="_blank">Infaktu</a>, ktÃ³ry odpowiedzialny jest za obsÅ‚ugÄ™ faktur, ale skupiaÄ‡ bÄ™dÄ™ siÄ™ gÅ‚Ã³wnie na dopiÄ™ciu caÅ‚oÅ›ci w Make (a nie na opisie dziaÅ‚ania wspomnianych platform). W artykule sÄ…/bÄ™dÄ… podlinkowane odpowiednie miejsca, wiÄ™c jak chcesz, to moÅ¼esz sprawdziÄ‡ szczegÃ³Å‚y na dany temat.
</Callout>

---

## Tworzenie scenariusza

MiÄ™sem Make sÄ… _Scenarios_, czyli sekwencje nastÄ™pujÄ…cy po sobie (a czasem i rÃ³wnolegle) zdarzeÅ„. Czym sÄ… scenariusze i jak dziaÅ‚ajÄ… przeczytasz nieco szerzej [tutaj](/wpisy/make-doskonale-narzedzie-do-automatyzacji).

<BlogPostImage
  src={makeScenario}
  alt="PrzykÅ‚adowy scenariusz w Make.com"
  figcaption="PrzykÅ‚adowy scenariusz w Make.com"
/>

Zatem do dzieÅ‚a! ğŸ™Œ

### 1. ModuÅ‚ Notion i Search Objects

Triggerem, czyli zdarzeniem wywoÅ‚ujÄ…cym caÅ‚Ä… sekwencjÄ™ bÄ™dzie czynnoÅ›Ä‡ wykonana w Notion. Konkretnie mÃ³wiÄ…c, bÄ™dzie to po prostu klikniÄ™cie checkboxa (a raczej dwÃ³ch).

Lecimy:

1. PrzechodzÄ™ do Make i wybieram z lewego sidebara **_Scenarios_** i **_+ Create a new scenario_**
2. Klikam w pustÄ… jeszcze planszÄ™ prawym przyciskiem myszy, wybieram **_Add module_** i odnajdujÄ™ Notion (pomaga mi w tym charakterystyczny logotyp).
3. NastÄ™pnie, juÅ¼ w obrÄ™bie moduÅ‚u Notion, odnajdujÄ™ **_Search Objects_**. WewnÄ…trz tego moduÅ‚u wskazujÄ™, ktÃ³ry element ma _zostaÄ‡ odnaleziony_.

<Callout>
**Å¹rÃ³dÅ‚o danych**

To jak finalnie bÄ™dzie wyglÄ…dÄ…Ä‡ widok w Notion, zaleÅ¼y od Ciebie. WaÅ¼ne, Å¼eby znalazÅ‚y siÄ™ tam pola (wraz z danymi), ktÃ³re chcesz przekazaÄ‡ do Make. U mnie wyglÄ…da to tak:

<BlogPostImage
  src={notionTasks}
  alt="Struktura to-do listy w Notion"
  figcaption="Struktura to-do listy w Notion"
/>

Mam konkretne zadanie, a w nim informacje ktÃ³re przekazujÄ™ do zewnÄ™trznych platform. _Task_, _Price_ (taki format wymagany jest przez Infakt) i _Related Company_ (zerknij na uwagÄ™ poniÅ¼ej) potrzebne mi bÄ™dÄ… do obsÅ‚ugi faktur w Infakcie, z kolei Make pobiera informacje z pÃ³l _Run scripts_ oraz _Autogenerated invoice via Make_ (nazwy mogÄ… byÄ‡ dowolne).
</Callout>

<Callout>
**WaÅ¼ne!**

_Related Company_ to pole typu _Relation_ i potrzebne jest do poprawnego wystawienia faktury. NiespodziankÄ… byÅ‚o dla mnie, Å¼e przygotowujÄ…c scenariusz, pole to udostÄ™pnia Make tylko _ID_ firmy. Potrzebna jest natomiast peÅ‚na nazwa i w obecnym momencie nie wiem, w jaki sposÃ³b mogÄ™ jÄ… wyciÄ…gnÄ…Ä‡ w Make po _ID_.

Workaround jaki zastosowaÅ‚em, to dodanie dodatkowego pola _Rollup_ (w Notion jest ukryte, Å¼eby nie powtarzaÄ‡ 2 razy tego samego), ktÃ³re po poÅ‚Ä…czeniu go z _Related Company_ udostÄ™pnia potrzebne informacje.

JeÅ›li wiesz jak to zrobiÄ‡ lepiej, to daj znaÄ‡ ğŸ¤“
</Callout>

---

#### Przekazanie danych z Notion do Make

Wracam do moduÅ‚u **_Search Objects_** i uzupeÅ‚niam kolejno:

1. **_Connection_** - jeÅ›li jeszcze nie poÅ‚Ä…czyÅ‚eÅ› Make z Notion, to naleÅ¼y to teraz wykonaÄ‡. Jak nie chcesz bawiÄ‡ siÄ™ w udostÄ™pnianie tylko konkretnych miejsc w Notion, wybierz **_Notion Public_**. Ja wybieram wÅ‚aÅ›nie ten rodzaj.
2. **_Search Objects_** - podajÄ™ **_Database Items_**
3. **_Database ID_** - ID strony Notion, na ktÃ³rej znajdujÄ… siÄ™ dane. Pobieram je bezpoÅ›rednio z adresu URL: _notion.so/id_

<Callout>
**Uwaga!**

KaÅ¼da nowa baza/strona w Notion dodana po autoryzacji z Make musi byÄ‡ osobno, rÄ™cznie poÅ‚Ä…czona. RobiÄ™ to z poziomu danej strony w Notion, klikajÄ…c 3 kropeczki w prawym gÃ³rnym rogu i wybierajÄ…c znajdujÄ…cÄ… siÄ™ na samym dole opcjÄ™ _Add Connections_.

</Callout>

4. **_Filter_** - miejsce, ktÃ³re zarzÄ…dza caÅ‚ym scenariuszem. Tutaj w ruch idÄ… wspomniane wyÅ¼ej checkboxy.
   W momencie kiedy zadanie jest zrealizowane, zaznaczam **_Run scripts_** co jest sygnaÅ‚em dla Make, Å¼e podczas wywoÅ‚ania scenariusza, do tego zadania moÅ¼e zostaÄ‡ wystawiona faktura.

   Drugim, rÃ³wnie istotnym checkbox'em jest **_Autogenerated invoice via Make_**, ktÃ³ry z kolei zapobiega dublom. Podczas startu scenariusza jest on pusty, a dopiero w momencie zakoÅ„czenia sekwencji, automatycznie zostaje odfajkowany. PoniewaÅ¼ chcÄ™, Å¼eby Make braÅ‚ pod uwagÄ™ zadania z aktywnym **_Run scripts_** i z nieaktywnym **_Autogenerated invoice via Make_**. Zatem mÃ³j warunek wyglÄ…da tak:

<BlogPostImage
  src={makeNotionFilter}
  alt="Filtr w module Notion: Search Object"
  figcaption="Filtr w module Notion: Search Object"
/>

âŒ˜+S (Ctrl+S) i zapisujÄ™ zmiany.

---

### 2. ModuÅ‚ HTTP i wykorzystanie API Infaktu

Nawet jeÅ›li aplikacja/platforma nie ma bezpoÅ›redniej integracji z Make (tak jest np. w przypadku Notion), to jeÅ›li tylko miejsce, z ktÃ³rym chcÄ™ siÄ™ poÅ‚Ä…czyÄ‡ udostÄ™pnia interfejs API, caÅ‚y cyfrowy Å›wiat stoi przede mnÄ… otworem.

Na szczÄ™Å›cie Infakt to porzÄ…dna firma i takimÅ¼e API dysponuje.

 _Do komputra!_

#### Wystawienie faktury

Prawy klik i odszukujÄ™ moduÅ‚ **_HTTP_**.

<Callout>
  Na tym etapie musisz mieÄ‡ wygenerowany klucz API Infaktu. JeÅ›li jeszcze tego
  nie zrobiÅ‚eÅ›, [tutaj](/wpisy/jak-wygenerowac-klucz-api-w-infakt) sprawdzisz
  jak to zrobisz w parÄ™ chwil.
</Callout>

<Callout>
  Jeszcze jedno: jeÅ›li rÃ³wnieÅ¼ tworzysz integracjÄ™ z Infakt (no bo wykorzystany przykÅ‚ad pewnie zagra teÅ¼ z innymi platformami), warto mieÄ‡ otwartÄ… <a href="https://docs.infakt.pl/" target="_blank_">dokumentacjÄ™ API</a>. Nie bÄ™dÄ™ skupiaÅ‚ siÄ™ na samych requestach jakoÅ› specjalnie. PrzykÅ‚ady z dokumentacji powinny w zupeÅ‚noÅ›ci wystarczyÄ‡.
</Callout>

Po kolei:

1. **_Credentials_** - podajÄ™ wygenerowany klucz API wraz z konkretnÄ… nazwÄ… (na dzieÅ„ pisania posta jest to **_X-API-Key_**)
2. **_URL_** - wybrany **_endpoint_**. W przypadku wystawienia faktury jest to ***https://api.infakt.pl/v3/invoices.json***
3. **_Method_** - rodzaj zapytania, w tym scenariuszu to **_POST_**
4. **_Headers_** - nie ruszam
5. **_Query String_** - nie ruszam
6. **_Body Type_** - zostawiam domyÅ›lne **_Raw_**
7. **_Content Type_** - wybieram **_JSON_**
8. **_Request Content_** - kopiujÄ™ z <a href="https://docs.infakt.pl/#6fe35880-014f-4890-bf18-bf373899ca2a" target="_blank_">dokumentacji Infaktu</a> **_body_** zapytania. InteresujÄ…ce mnie dane podmieniam na informacje otrzymane z Notion (po klikniÄ™ciu w miejsce gdzie wklejasz kod pojawi siÄ™ okienko ze wszystkimi dostÄ™pnymi danymi). W moim przypadku interesuje mnie **_client_company_name_** gdzie dostarczam nazwÄ™ klienta z pola **_Rollup_** (opisujÄ™ to szczegÃ³Å‚owo kawaÅ‚ek wyÅ¼ej) oraz **_name_**, **_net_price_** i **_unit_net_price_** z tablicy **_services_**
9. **_Parse response_** - **WAÅ»E!** Zaznaczamy **_Yes_**, bo dziÄ™ki temu mogÄ™ ominÄ…Ä‡ dodanie w Make dodatkowego moduÅ‚u **_JSON_**. W kolejnym module od razu mam dostÄ™p do potrzebnych danych.

<BlogPostImage
  src={makeHttpCreate}
  alt="Struktura moduÅ‚u HTTP"
  figcaption="Struktura moduÅ‚u HTTP"
/>

#### WysÅ‚anie faktury

WysyÅ‚ka faktury realizowana jest bardzo podobnie, tak Å¼e kolejny moduÅ‚ to rÃ³wnieÅ¼ HTTP. Zmieniam jedynie **_endpoint_** (sprawdÅº <a href="https://docs.infakt.pl/#f410d26b-0c38-47fb-8224-7f500a5f3666" target="_blank_">dokumentacjÄ™</a>) oraz **_body_**, ktÃ³re w tym konkretnym przypadku zostawiam puste. Spowoduje to pobranie domyÅ›lnego adresu klienta ustawionego bezpoÅ›rednio w Infakcie.

Jak widzisz w dokumentacji, **_endpoint_** wymaga dynamicznego przekazania **_ID_** wystawionej przed momentem faktury. DziÄ™ki zaznaczonemu w ustawieniach poprzedniego moduÅ‚u **_Parse response_** mam teraz bezpoÅ›redni dostÄ™p do wszystkich informacji udostÄ™pnianych podczas tworzenia dokumentu. Wystarczy wklikaÄ‡ siÄ™ w odpowiednie miejsce i wybraÄ‡ z dostÄ™pnej listy danych **_ID_**.

Bajka! âœ¨

<BlogPostImage
  src={makeHttpSend}
  alt="Struktura moduÅ‚u HTTP"
  figcaption="Struktura moduÅ‚u HTTP"
/>

### Koniec sekwencji i moduÅ‚ Notion: Update a Database Item

Po wystawieniu i wysÅ‚aniu faktury, wracam do moduÅ‚u zwiÄ…zanego z Notion i przekazujÄ™ informacjÄ™ o zmianie statusu checkboxa **_Autogenerated invoice via Make_** z **_false_** na **_true_** przez co zadanie zostaje w caÅ‚oÅ›ci zamkniÄ™te i nie jest uwzglÄ™dniane podczas kolejnego wywoÅ‚ania sekwencji.

Nie korzystam tutaj z **_Search Object_** jak to byÅ‚o za pierwszym razem, a z **_Update a Database Item_**. Sam moduÅ‚ wyglÄ…da podobnie, choÄ‡ naturalnie sÄ… rÃ³Å¼nice. SprawdÅº poniÅ¼ej:

<BlogPostImage
  src={makeNotionUpdateDatabase}
  alt="Struktura moduÅ‚u Notion: Update Database Item"
  figcaption="Struktura moduÅ‚u Notion: Update Database Item"
/>

Podczas kolejnego wywoÅ‚ania sekwencji zakoÅ„czone zadanie z zaznaczonym checkboxem **_Autogenerated invoice via Make_** nie zostanie uwzglÄ™dnione.

PoniÅ¼ej caÅ‚y scenariusz:

<BlogPostImage
  src={makeScenario}
  alt="PrzykÅ‚adowy scenariusz w Make.com"
  figcaption="PrzykÅ‚adowy scenariusz w Make.com"
/>

## Dobre rzeczy wspominane w artykule (referale)
- <a href="https://www.make.com/en/register?pc=filipchrapek" target="_blank">ZaÅ‚Ã³Å¼ konto w Make</a>
- <a href="https://affiliate.notion.so/b4jvkcj24dj6" target="_blank">ZaÅ‚Ã³Å¼ konto w Notion</a>
- <a href="https://www.infakt.pl/polecam/fchrapek-infakt" target="_blank">ZaÅ‚Ã³Å¼ konto w Infakt</a>
